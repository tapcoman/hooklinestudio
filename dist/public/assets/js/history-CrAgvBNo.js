import{h as R,u as U,r as v,a as B,c as f,z as S,g as d,j as e,B as r,A as T,C as m,G as Y,H as K,d as j,e as y,I as Q,n as E,o as L,p as D,E as _}from"./index-BgezxcFr.js";import{C as $,H as J,D as P,a as H,b as I,c as o}from"./dropdown-menu-C8mOzfKO.js";import{u as G}from"./useQuery-BDhHusTH.js";import{D as z}from"./download-C98XEgdc.js";import{S as W,F as X}from"./search-DnMaoyHE.js";import{C as Z}from"./calendar-Cb0AWD16.js";import{T as ee}from"./trash-2-D3e-V8_d.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=R("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function oe(){const[,w]=U(),[i,F]=v.useState(""),[n,x]=v.useState("all"),[t,b]=v.useState(null),{toast:l}=B(),{data:g}=G({queryKey:["/api/users/me"],queryFn:()=>d("GET","/api/users/me").then(s=>s.json())}),{data:q,isLoading:M}=G({queryKey:["/api/generations"],queryFn:()=>d("GET","/api/generations").then(s=>s.json())}),A=f({mutationFn:async({generationId:s,hookIndex:a})=>(await d("POST","/api/favorites",{userId:g?.id,generationId:s,hookIndex:a})).json(),onSuccess:()=>{l({title:"Hook saved to favorites!",description:"You can view it in your favorites page."}),S.invalidateQueries({queryKey:["/api/favorites",g?.id]})},onError:()=>{l({title:"Error saving hook",description:"Please try again.",variant:"destructive"})}}),O=f({mutationFn:async s=>(await d("DELETE",`/api/generations/${s}`)).json(),onSuccess:()=>{l({title:"Generation deleted",description:"The hook generation has been removed from your history."}),S.invalidateQueries({queryKey:["/api/generations"]})},onError:()=>{l({title:"Error deleting generation",description:"Please try again.",variant:"destructive"})}}),V=async s=>{try{await navigator.clipboard.writeText(s),l({title:"Copied to clipboard!",description:"Hook text has been copied."})}catch{l({title:"Copy failed",description:"Please try selecting and copying manually.",variant:"destructive"})}},N=f({mutationFn:async s=>{const a=await d("POST","/api/export-csv",{generationId:s}),p=await a.blob(),u=window.URL.createObjectURL(p),c=document.createElement("a");return c.style.display="none",c.href=u,c.download=`hooks-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(u),document.body.removeChild(c),a},onSuccess:()=>{l({title:"CSV exported!",description:"Your hooks have been downloaded."})},onError:()=>{l({title:"Export failed",description:"Please try again.",variant:"destructive"})}}),k=s=>s?(typeof s=="string"?new Date(s):s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date",C=s=>{switch(s){case"tiktok":return e.jsx(E,{className:"w-4 h-4"});case"instagram":return e.jsx(L,{className:"w-4 h-4 text-pink-500"});case"youtube":return e.jsx(D,{className:"w-4 h-4 text-red-600"});default:return null}},h=q?.filter(s=>{const a=i===""||s.topic?.toLowerCase().includes(i.toLowerCase())||s.hooks?.some(u=>u.hook.toLowerCase().includes(i.toLowerCase())),p=n==="all"||s.platform===n;return a&&p})||[];return t?e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(r,{variant:"ghost",onClick:()=>b(null),className:"mb-4",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Back to History"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Hook Generation Details"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[C(t.platform),e.jsx("span",{className:"capitalize",children:t.platform})]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:k(t.createdAt)}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:t.objective?.replace("_"," ")})]})]}),e.jsxs(r,{variant:"outline",onClick:()=>N.mutate(t.id),disabled:N.isPending,children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs(m,{className:"mb-6",children:[e.jsx(Y,{children:e.jsx(K,{className:"text-lg",children:"Video Topic"})}),e.jsx(j,{children:e.jsx("p",{className:"text-slate leading-relaxed",children:t.topic})})]}),e.jsx("div",{className:"space-y-4",children:t.hooks.map((s,a)=>e.jsxs(m,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(y,{variant:"outline",className:"text-xs",children:s.framework}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>V(s.hook),children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>A.mutate({generationId:t.id,hookIndex:a}),children:e.jsx(J,{className:"w-4 h-4"})})]})]}),e.jsxs("p",{className:"text-navy font-medium mb-2",children:['"',s.hook,'"']}),e.jsx("p",{className:"text-sm text-slate mb-2",children:s.rationale}),s.platformNotes&&e.jsxs("p",{className:"text-xs text-slate bg-slate-50 p-2 rounded",children:["Platform note: ",s.platformNotes]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-slate",children:[e.jsxs("span",{children:["Score: ",s.score,"/5"]}),e.jsxs("span",{children:[s.wordCount," words"]})]})]},a))})]})}):e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(r,{variant:"ghost",onClick:()=>w("/app"),className:"mb-4",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Back to Studio"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Generation History"}),e.jsxs("p",{className:"text-slate",children:[h.length," generation",h.length!==1?"s":""," found"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate w-4 h-4"}),e.jsx(Q,{placeholder:"Search hooks or topics...",value:i,onChange:s=>F(s.target.value),className:"pl-10 w-full sm:w-64"})]}),e.jsxs(P,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),n==="all"?"All Platforms":n]})}),e.jsxs(I,{children:[e.jsx(o,{onClick:()=>x("all"),children:"All Platforms"}),e.jsxs(o,{onClick:()=>x("tiktok"),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"TikTok"]}),e.jsxs(o,{onClick:()=>x("instagram"),children:[e.jsx(L,{className:"w-4 h-4 mr-2 text-pink-500"}),"Instagram"]}),e.jsxs(o,{onClick:()=>x("youtube"),children:[e.jsx(D,{className:"w-4 h-4 mr-2 text-red-600"}),"YouTube"]})]})]})]})]})]}),M?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsx(m,{className:"animate-pulse",children:e.jsxs(j,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/4 mb-3"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]})},a))}):h.length===0?e.jsx(m,{className:"text-center py-12",children:e.jsxs(j,{children:[e.jsx(Z,{className:"w-16 h-16 text-slate mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2",children:i||n!=="all"?"No results found":"No generation history yet"}),e.jsx("p",{className:"text-slate mb-6",children:i||n!=="all"?"Try adjusting your search or filters":"Start generating hooks to see your history here"}),!i&&n==="all"&&e.jsx(r,{onClick:()=>w("/app"),children:"Create Your First Hooks"})]})}):e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx(m,{className:"hover:shadow-md transition-shadow",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[C(s.platform),e.jsx(y,{variant:"secondary",className:"capitalize",children:s.platform})]}),e.jsx(y,{variant:"outline",className:"capitalize",children:s.objective?.replace("_"," ")}),e.jsx("span",{className:"text-sm text-slate",children:k(s.createdAt)})]}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2 line-clamp-2",children:s.topic}),e.jsxs("div",{className:"text-sm text-slate mb-3",children:[s.hooks?.length," hooks generated"]}),s.hooks&&s.hooks.length>0&&e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-sm text-slate font-medium mb-1",children:"Top hook:"}),e.jsxs("p",{className:"text-sm text-navy line-clamp-2",children:['"',s.hooks[0].hook,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>b(s),children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"View"]}),e.jsxs(P,{children:[e.jsx(H,{asChild:!0,children:e.jsx(r,{variant:"ghost",size:"sm",children:e.jsx(se,{className:"w-4 h-4"})})}),e.jsxs(I,{align:"end",children:[e.jsxs(o,{onClick:()=>N.mutate(s.id),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(o,{onClick:()=>O.mutate(s.id),className:"text-red-600",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})})},s.id))})]})})}export{oe as default};
//# sourceMappingURL=history-CrAgvBNo.js.map
