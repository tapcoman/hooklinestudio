import{f as V,r as w,aR as E,e as y,j as e,i as L,aG as P,aL as K,aB as Y,aS as Q,aT as _,J as D,K as G,M as I,b8 as $,al as J,bb as W,aU as X}from"./react-vendor-BiQIbcdL-v2025.08.03.012.js";import{u as Z,q,d as h,B as i,C as p,o as ee,p as se,b as N,c as b,I as ae}from"./index-BydpgK2q-v2025.08.03.012.js";import{D as H,a as M,b as z,c as m}from"./dropdown-menu-CBFT4GDN-v2025.08.03.012.js";import"./vendor-9fi0qQp5-v2025.08.03.012.js";import"./utils-vendor-BTGVH9Kg-v2025.08.03.012.js";import"./ui-vendor-CLsjAtpL-v2025.08.03.012.js";function ce(){var T;const[,g]=V(),[n,F]=w.useState(""),[o,u]=w.useState("all"),[t,k]=w.useState(null),{toast:r}=Z(),{data:d}=E({queryKey:["/api/users/me"],queryFn:()=>h("GET","/api/users/me").then(s=>s.json())}),{data:v,isLoading:O}=E({queryKey:["/api/generations"],queryFn:()=>h("GET","/api/generations").then(s=>s.json())}),R=y({mutationFn:async({generationId:s,hookIndex:a})=>(await h("POST","/api/favorites",{userId:d==null?void 0:d.id,generationId:s,hookIndex:a})).json(),onSuccess:()=>{r({title:"Hook saved to favorites!",description:"You can view it in your favorites page."}),q.invalidateQueries({queryKey:["/api/favorites",d==null?void 0:d.id]})},onError:()=>{r({title:"Error saving hook",description:"Please try again.",variant:"destructive"})}}),U=y({mutationFn:async s=>(await h("DELETE",`/api/generations/${s}`)).json(),onSuccess:()=>{r({title:"Generation deleted",description:"The hook generation has been removed from your history."}),q.invalidateQueries({queryKey:["/api/generations"]})},onError:()=>{r({title:"Error deleting generation",description:"Please try again.",variant:"destructive"})}}),A=async s=>{try{await navigator.clipboard.writeText(s),r({title:"Copied to clipboard!",description:"Hook text has been copied."})}catch{r({title:"Copy failed",description:"Please try selecting and copying manually.",variant:"destructive"})}},f=y({mutationFn:async s=>{const a=await h("POST","/api/export-csv",{generationId:s}),c=await a.blob(),x=window.URL.createObjectURL(c),l=document.createElement("a");return l.style.display="none",l.href=x,l.download=`hooks-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(x),document.body.removeChild(l),a},onSuccess:()=>{r({title:"CSV exported!",description:"Your hooks have been downloaded."})},onError:()=>{r({title:"Export failed",description:"Please try again.",variant:"destructive"})}}),C=s=>s?(typeof s=="string"?new Date(s):s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date",S=s=>{switch(s){case"tiktok":return e.jsx(D,{className:"w-4 h-4"});case"instagram":return e.jsx(G,{className:"w-4 h-4 text-pink-500"});case"youtube":return e.jsx(I,{className:"w-4 h-4 text-red-600"});default:return null}},j=(v==null?void 0:v.filter(s=>{var x,l;const a=n===""||((x=s.topic)==null?void 0:x.toLowerCase().includes(n.toLowerCase()))||((l=s.hooks)==null?void 0:l.some(B=>B.hook.toLowerCase().includes(n.toLowerCase()))),c=o==="all"||s.platform===o;return a&&c}))||[];return t?e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(i,{variant:"ghost",onClick:()=>k(null),className:"mb-4",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Back to History"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Hook Generation Details"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[S(t.platform),e.jsx("span",{className:"capitalize",children:t.platform})]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:C(t.createdAt)}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:(T=t.objective)==null?void 0:T.replace("_"," ")})]})]}),e.jsxs(i,{variant:"outline",onClick:()=>f.mutate(t.id),disabled:f.isPending,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs(p,{className:"mb-6",children:[e.jsx(ee,{children:e.jsx(se,{className:"text-lg",children:"Video Topic"})}),e.jsx(N,{children:e.jsx("p",{className:"text-slate leading-relaxed",children:t.topic})})]}),e.jsx("div",{className:"space-y-4",children:t.hooks.map((s,a)=>e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(b,{variant:"outline",className:"text-xs",children:s.framework}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>A(s.hook),children:e.jsx(K,{className:"w-4 h-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>R.mutate({generationId:t.id,hookIndex:a}),children:e.jsx(Y,{className:"w-4 h-4"})})]})]}),e.jsxs("p",{className:"text-navy font-medium mb-2",children:['"',s.hook,'"']}),e.jsx("p",{className:"text-sm text-slate mb-2",children:s.rationale}),s.platformNotes&&e.jsxs("p",{className:"text-xs text-slate bg-slate-50 p-2 rounded",children:["Platform note: ",s.platformNotes]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-slate",children:[e.jsxs("span",{children:["Score: ",s.score,"/5"]}),e.jsxs("span",{children:[s.wordCount," words"]})]})]},a))})]})}):e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(i,{variant:"ghost",onClick:()=>g("/app"),className:"mb-4",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Back to Studio"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Generation History"}),e.jsxs("p",{className:"text-slate",children:[j.length," generation",j.length!==1?"s":""," found"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate w-4 h-4"}),e.jsx(ae,{placeholder:"Search hooks or topics...",value:n,onChange:s=>F(s.target.value),className:"pl-10 w-full sm:w-64"})]}),e.jsxs(H,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),o==="all"?"All Platforms":o]})}),e.jsxs(z,{children:[e.jsx(m,{onClick:()=>u("all"),children:"All Platforms"}),e.jsxs(m,{onClick:()=>u("tiktok"),children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"TikTok"]}),e.jsxs(m,{onClick:()=>u("instagram"),children:[e.jsx(G,{className:"w-4 h-4 mr-2 text-pink-500"}),"Instagram"]}),e.jsxs(m,{onClick:()=>u("youtube"),children:[e.jsx(I,{className:"w-4 h-4 mr-2 text-red-600"}),"YouTube"]})]})]})]})]})]}),O?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsx(p,{className:"animate-pulse",children:e.jsxs(N,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/4 mb-3"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]})},a))}):j.length===0?e.jsx(p,{className:"text-center py-12",children:e.jsxs(N,{children:[e.jsx($,{className:"w-16 h-16 text-slate mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2",children:n||o!=="all"?"No results found":"No generation history yet"}),e.jsx("p",{className:"text-slate mb-6",children:n||o!=="all"?"Try adjusting your search or filters":"Start generating hooks to see your history here"}),!n&&o==="all"&&e.jsx(i,{onClick:()=>g("/app"),children:"Create Your First Hooks"})]})}):e.jsx("div",{className:"space-y-4",children:j.map(s=>{var a,c;return e.jsx(p,{className:"hover:shadow-md transition-shadow",children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[S(s.platform),e.jsx(b,{variant:"secondary",className:"capitalize",children:s.platform})]}),e.jsx(b,{variant:"outline",className:"capitalize",children:(a=s.objective)==null?void 0:a.replace("_"," ")}),e.jsx("span",{className:"text-sm text-slate",children:C(s.createdAt)})]}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2 line-clamp-2",children:s.topic}),e.jsxs("div",{className:"text-sm text-slate mb-3",children:[(c=s.hooks)==null?void 0:c.length," hooks generated"]}),s.hooks&&s.hooks.length>0&&e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-sm text-slate font-medium mb-1",children:"Top hook:"}),e.jsxs("p",{className:"text-sm text-navy line-clamp-2",children:['"',s.hooks[0].hook,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>k(s),children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"View"]}),e.jsxs(H,{children:[e.jsx(M,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",children:e.jsx(W,{className:"w-4 h-4"})})}),e.jsxs(z,{align:"end",children:[e.jsxs(m,{onClick:()=>f.mutate(s.id),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(m,{onClick:()=>U.mutate(s.id),className:"text-red-600",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})})},s.id)})})]})})}export{ce as default};
