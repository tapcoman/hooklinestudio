import{r as N,j as e}from"./react-vendor-ilJwshTJ-v2025.08.03.008.js";import{u as U,a as V,c as f,t as S,f as d,B as l,C as m,v as B,w as K,d as j,e as w,I as Y,k as T,l as E,m as D}from"./index-ZEp8XnoT-v2025.08.03.008.js";import{D as L,a as P,b as I,c}from"./dropdown-menu-uzfhRm3f-v2025.08.03.008.js";import{u as G}from"./useQuery-Dmt6scec-v2025.08.03.008.js";import{A as H,D as q,K as Q,u as _,$,a0 as J,a4 as W,E as X,a6 as Z,a1 as ee}from"./utils-vendor-CQ6QKTrk-v2025.08.03.008.js";import"./ui-vendor-BYc2EWtq-v2025.08.03.008.js";function ne(){const[,y]=U(),[i,z]=N.useState(""),[n,x]=N.useState("all"),[t,b]=N.useState(null),{toast:r}=V(),{data:g}=G({queryKey:["/api/users/me"],queryFn:()=>d("GET","/api/users/me").then(s=>s.json())}),{data:F,isLoading:M}=G({queryKey:["/api/generations"],queryFn:()=>d("GET","/api/generations").then(s=>s.json())}),A=f({mutationFn:async({generationId:s,hookIndex:a})=>(await d("POST","/api/favorites",{userId:g?.id,generationId:s,hookIndex:a})).json(),onSuccess:()=>{r({title:"Hook saved to favorites!",description:"You can view it in your favorites page."}),S.invalidateQueries({queryKey:["/api/favorites",g?.id]})},onError:()=>{r({title:"Error saving hook",description:"Please try again.",variant:"destructive"})}}),O=f({mutationFn:async s=>(await d("DELETE",`/api/generations/${s}`)).json(),onSuccess:()=>{r({title:"Generation deleted",description:"The hook generation has been removed from your history."}),S.invalidateQueries({queryKey:["/api/generations"]})},onError:()=>{r({title:"Error deleting generation",description:"Please try again.",variant:"destructive"})}}),R=async s=>{try{await navigator.clipboard.writeText(s),r({title:"Copied to clipboard!",description:"Hook text has been copied."})}catch{r({title:"Copy failed",description:"Please try selecting and copying manually.",variant:"destructive"})}},v=f({mutationFn:async s=>{const a=await d("POST","/api/export-csv",{generationId:s}),p=await a.blob(),u=window.URL.createObjectURL(p),o=document.createElement("a");return o.style.display="none",o.href=u,o.download=`hooks-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(u),document.body.removeChild(o),a},onSuccess:()=>{r({title:"CSV exported!",description:"Your hooks have been downloaded."})},onError:()=>{r({title:"Export failed",description:"Please try again.",variant:"destructive"})}}),k=s=>s?(typeof s=="string"?new Date(s):s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date",C=s=>{switch(s){case"tiktok":return e.jsx(T,{className:"w-4 h-4"});case"instagram":return e.jsx(E,{className:"w-4 h-4 text-pink-500"});case"youtube":return e.jsx(D,{className:"w-4 h-4 text-red-600"});default:return null}},h=F?.filter(s=>{const a=i===""||s.topic?.toLowerCase().includes(i.toLowerCase())||s.hooks?.some(u=>u.hook.toLowerCase().includes(i.toLowerCase())),p=n==="all"||s.platform===n;return a&&p})||[];return t?e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(l,{variant:"ghost",onClick:()=>b(null),className:"mb-4",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Back to History"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Hook Generation Details"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[C(t.platform),e.jsx("span",{className:"capitalize",children:t.platform})]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:k(t.createdAt)}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:t.objective?.replace("_"," ")})]})]}),e.jsxs(l,{variant:"outline",onClick:()=>v.mutate(t.id),disabled:v.isPending,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs(m,{className:"mb-6",children:[e.jsx(B,{children:e.jsx(K,{className:"text-lg",children:"Video Topic"})}),e.jsx(j,{children:e.jsx("p",{className:"text-slate leading-relaxed",children:t.topic})})]}),e.jsx("div",{className:"space-y-4",children:t.hooks.map((s,a)=>e.jsxs(m,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(w,{variant:"outline",className:"text-xs",children:s.framework}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>R(s.hook),children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>A.mutate({generationId:t.id,hookIndex:a}),children:e.jsx(_,{className:"w-4 h-4"})})]})]}),e.jsxs("p",{className:"text-navy font-medium mb-2",children:['"',s.hook,'"']}),e.jsx("p",{className:"text-sm text-slate mb-2",children:s.rationale}),s.platformNotes&&e.jsxs("p",{className:"text-xs text-slate bg-slate-50 p-2 rounded",children:["Platform note: ",s.platformNotes]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-slate",children:[e.jsxs("span",{children:["Score: ",s.score,"/5"]}),e.jsxs("span",{children:[s.wordCount," words"]})]})]},a))})]})}):e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(l,{variant:"ghost",onClick:()=>y("/app"),className:"mb-4",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Back to Studio"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-2",children:"Generation History"}),e.jsxs("p",{className:"text-slate",children:[h.length," generation",h.length!==1?"s":""," found"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate w-4 h-4"}),e.jsx(Y,{placeholder:"Search hooks or topics...",value:i,onChange:s=>z(s.target.value),className:"pl-10 w-full sm:w-64"})]}),e.jsxs(L,{children:[e.jsx(P,{asChild:!0,children:e.jsxs(l,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),n==="all"?"All Platforms":n]})}),e.jsxs(I,{children:[e.jsx(c,{onClick:()=>x("all"),children:"All Platforms"}),e.jsxs(c,{onClick:()=>x("tiktok"),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"TikTok"]}),e.jsxs(c,{onClick:()=>x("instagram"),children:[e.jsx(E,{className:"w-4 h-4 mr-2 text-pink-500"}),"Instagram"]}),e.jsxs(c,{onClick:()=>x("youtube"),children:[e.jsx(D,{className:"w-4 h-4 mr-2 text-red-600"}),"YouTube"]})]})]})]})]})]}),M?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsx(m,{className:"animate-pulse",children:e.jsxs(j,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/4 mb-3"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]})},a))}):h.length===0?e.jsx(m,{className:"text-center py-12",children:e.jsxs(j,{children:[e.jsx(W,{className:"w-16 h-16 text-slate mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2",children:i||n!=="all"?"No results found":"No generation history yet"}),e.jsx("p",{className:"text-slate mb-6",children:i||n!=="all"?"Try adjusting your search or filters":"Start generating hooks to see your history here"}),!i&&n==="all"&&e.jsx(l,{onClick:()=>y("/app"),children:"Create Your First Hooks"})]})}):e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx(m,{className:"hover:shadow-md transition-shadow",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[C(s.platform),e.jsx(w,{variant:"secondary",className:"capitalize",children:s.platform})]}),e.jsx(w,{variant:"outline",className:"capitalize",children:s.objective?.replace("_"," ")}),e.jsx("span",{className:"text-sm text-slate",children:k(s.createdAt)})]}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-2 line-clamp-2",children:s.topic}),e.jsxs("div",{className:"text-sm text-slate mb-3",children:[s.hooks?.length," hooks generated"]}),s.hooks&&s.hooks.length>0&&e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-sm text-slate font-medium mb-1",children:"Top hook:"}),e.jsxs("p",{className:"text-sm text-navy line-clamp-2",children:['"',s.hooks[0].hook,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>b(s),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"View"]}),e.jsxs(L,{children:[e.jsx(P,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(Z,{className:"w-4 h-4"})})}),e.jsxs(I,{align:"end",children:[e.jsxs(c,{onClick:()=>v.mutate(s.id),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(c,{onClick:()=>O.mutate(s.id),className:"text-red-600",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})})},s.id))})]})})}export{ne as default};
