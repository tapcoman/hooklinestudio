var lt=e=>{throw TypeError(e)};var G=(e,t,i)=>t.has(e)||lt("Cannot "+i);var s=(e,t,i)=>(G(e,t,"read from private field"),i?i.call(e):t.get(e)),p=(e,t,i)=>t.has(e)?lt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),h=(e,t,i,r)=>(G(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),l=(e,t,i)=>(G(e,t,"access private method"),i);import{ay as Ot,az as dt,aA as m,aB as J,aC as B,aD as X,aE as Y,aF as ft,aG as St,aH as Et,aI as Qt,aJ as pt,aK as gt,r as O,aL as Tt,aM as It}from"./index-BNCjXCrl-v2025.08.03.001.js";var v,a,A,b,I,D,S,E,H,P,U,w,x,Q,M,n,k,Z,$,q,tt,et,st,it,mt,yt,wt=(yt=class extends Ot{constructor(t,i){super();p(this,n);p(this,v);p(this,a);p(this,A);p(this,b);p(this,I);p(this,D);p(this,S);p(this,E);p(this,H);p(this,P);p(this,U);p(this,w);p(this,x);p(this,Q);p(this,M,new Set);this.options=i,h(this,v,t),h(this,E,null),h(this,S,dt()),this.options.experimental_prefetchInRender||s(this,S).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(i)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,a).addObserver(this),bt(s(this,a),this.options)?l(this,n,k).call(this):this.updateResult(),l(this,n,tt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return rt(s(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return rt(s(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,l(this,n,et).call(this),l(this,n,st).call(this),s(this,a).removeObserver(this)}setOptions(t){const i=this.options,r=s(this,a);if(this.options=s(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof m(this.options.enabled,s(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");l(this,n,it).call(this),s(this,a).setOptions(this.options),i._defaulted&&!J(this.options,i)&&s(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,a),observer:this});const c=this.hasListeners();c&&Rt(s(this,a),r,this.options,i)&&l(this,n,k).call(this),this.updateResult(),c&&(s(this,a)!==r||m(this.options.enabled,s(this,a))!==m(i.enabled,s(this,a))||B(this.options.staleTime,s(this,a))!==B(i.staleTime,s(this,a)))&&l(this,n,Z).call(this);const u=l(this,n,$).call(this);c&&(s(this,a)!==r||m(this.options.enabled,s(this,a))!==m(i.enabled,s(this,a))||u!==s(this,Q))&&l(this,n,q).call(this,u)}getOptimisticResult(t){const i=s(this,v).getQueryCache().build(s(this,v),t),r=this.createResult(i,t);return Ft(this,r)&&(h(this,b,r),h(this,D,this.options),h(this,I,s(this,a).state)),r}getCurrentResult(){return s(this,b)}trackResult(t,i){return new Proxy(t,{get:(r,c)=>(this.trackProp(c),i?.(c),Reflect.get(r,c))})}trackProp(t){s(this,M).add(t)}getCurrentQuery(){return s(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const i=s(this,v).defaultQueryOptions(t),r=s(this,v).getQueryCache().build(s(this,v),i);return r.fetch().then(()=>this.createResult(r,i))}fetch(t){return l(this,n,k).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,b)))}createResult(t,i){const r=s(this,a),c=this.options,u=s(this,b),o=s(this,I),_=s(this,D),g=t!==r?t.state:s(this,A),{state:L}=t;let d={...L},j=!1,R;if(i._optimisticResults){const y=this.hasListeners(),z=!y&&bt(t,i),F=y&&Rt(t,r,i,c);(z||F)&&(d={...d,...Qt(L.data,t.options)}),i._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:nt,errorUpdatedAt:ot,status:T}=d;R=d.data;let ht=!1;if(i.placeholderData!==void 0&&R===void 0&&T==="pending"){let y;u?.isPlaceholderData&&i.placeholderData===_?.placeholderData?(y=u.data,ht=!0):y=typeof i.placeholderData=="function"?i.placeholderData(s(this,U)?.state.data,s(this,U)):i.placeholderData,y!==void 0&&(T="success",R=pt(u?.data,y,i),j=!0)}if(i.select&&R!==void 0&&!ht)if(u&&R===o?.data&&i.select===s(this,H))R=s(this,P);else try{h(this,H,i.select),R=i.select(R),R=pt(u?.data,R,i),h(this,P,R),h(this,E,null)}catch(y){h(this,E,y)}s(this,E)&&(nt=s(this,E),R=s(this,P),ot=Date.now(),T="error");const W=d.fetchStatus==="fetching",K=T==="pending",N=T==="error",ct=K&&W,ut=R!==void 0,C={status:T,fetchStatus:d.fetchStatus,isPending:K,isSuccess:T==="success",isError:N,isInitialLoading:ct,isLoading:ct,data:R,dataUpdatedAt:d.dataUpdatedAt,error:nt,errorUpdatedAt:ot,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>g.dataUpdateCount||d.errorUpdateCount>g.errorUpdateCount,isFetching:W,isRefetching:W&&!K,isLoadingError:N&&!ut,isPaused:d.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:N&&ut,isStale:at(t,i),refetch:this.refetch,promise:s(this,S),isEnabled:m(i.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const y=V=>{C.status==="error"?V.reject(C.error):C.data!==void 0&&V.resolve(C.data)},z=()=>{const V=h(this,S,C.promise=dt());y(V)},F=s(this,S);switch(F.status){case"pending":t.queryHash===r.queryHash&&y(F);break;case"fulfilled":(C.status==="error"||C.data!==F.value)&&z();break;case"rejected":(C.status!=="error"||C.error!==F.reason)&&z();break}}return C}updateResult(){const t=s(this,b),i=this.createResult(s(this,a),this.options);if(h(this,I,s(this,a).state),h(this,D,this.options),s(this,I).data!==void 0&&h(this,U,s(this,a)),J(i,t))return;h(this,b,i);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:c}=this.options,u=typeof c=="function"?c():c;if(u==="all"||!u&&!s(this,M).size)return!0;const o=new Set(u??s(this,M));return this.options.throwOnError&&o.add("error"),Object.keys(s(this,b)).some(_=>{const f=_;return s(this,b)[f]!==t[f]&&o.has(f)})};l(this,n,mt).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&l(this,n,tt).call(this)}},v=new WeakMap,a=new WeakMap,A=new WeakMap,b=new WeakMap,I=new WeakMap,D=new WeakMap,S=new WeakMap,E=new WeakMap,H=new WeakMap,P=new WeakMap,U=new WeakMap,w=new WeakMap,x=new WeakMap,Q=new WeakMap,M=new WeakMap,n=new WeakSet,k=function(t){l(this,n,it).call(this);let i=s(this,a).fetch(this.options,t);return t?.throwOnError||(i=i.catch(X)),i},Z=function(){l(this,n,et).call(this);const t=B(this.options.staleTime,s(this,a));if(Y||s(this,b).isStale||!ft(t))return;const r=St(s(this,b).dataUpdatedAt,t)+1;h(this,w,setTimeout(()=>{s(this,b).isStale||this.updateResult()},r))},$=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,a)):this.options.refetchInterval)??!1},q=function(t){l(this,n,st).call(this),h(this,Q,t),!(Y||m(this.options.enabled,s(this,a))===!1||!ft(s(this,Q))||s(this,Q)===0)&&h(this,x,setInterval(()=>{(this.options.refetchIntervalInBackground||Et.isFocused())&&l(this,n,k).call(this)},s(this,Q)))},tt=function(){l(this,n,Z).call(this),l(this,n,q).call(this,l(this,n,$).call(this))},et=function(){s(this,w)&&(clearTimeout(s(this,w)),h(this,w,void 0))},st=function(){s(this,x)&&(clearInterval(s(this,x)),h(this,x,void 0))},it=function(){const t=s(this,v).getQueryCache().build(s(this,v),this.options);if(t===s(this,a))return;const i=s(this,a);h(this,a,t),h(this,A,t.state),this.hasListeners()&&(i?.removeObserver(this),t.addObserver(this))},mt=function(t){gt.batch(()=>{t.listeners&&this.listeners.forEach(i=>{i(s(this,b))}),s(this,v).getQueryCache().notify({query:s(this,a),type:"observerResultsUpdated"})})},yt);function xt(e,t){return m(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function bt(e,t){return xt(e,t)||e.state.data!==void 0&&rt(e,t,t.refetchOnMount)}function rt(e,t,i){if(m(t.enabled,e)!==!1&&B(t.staleTime,e)!=="static"){const r=typeof i=="function"?i(e):i;return r==="always"||r!==!1&&at(e,t)}return!1}function Rt(e,t,i,r){return(e!==t||m(r.enabled,e)===!1)&&(!i.suspense||e.state.status!=="error")&&at(e,i)}function at(e,t){return m(t.enabled,e)!==!1&&e.isStaleByTime(B(t.staleTime,e))}function Ft(e,t){return!J(e.getCurrentResult(),t)}var Ct=O.createContext(!1),Dt=()=>O.useContext(Ct);Ct.Provider;function Pt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Ut=O.createContext(Pt()),Mt=()=>O.useContext(Ut),_t=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Lt=e=>{O.useEffect(()=>{e.clearReset()},[e])},kt=({result:e,errorResetBoundary:t,throwOnError:i,query:r,suspense:c})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(c&&e.data===void 0||Tt(i,[e.error,r])),Bt=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),i=e.staleTime;e.staleTime=typeof i=="function"?(...r)=>t(i(...r)):t(i),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},At=(e,t)=>e.isLoading&&e.isFetching&&!t,Ht=(e,t)=>e?.suspense&&t.isPending,vt=(e,t,i)=>t.fetchOptimistic(e).catch(()=>{i.clearReset()});function jt(e,t,i){const r=Dt(),c=Mt(),u=It(),o=u.defaultQueryOptions(e);u.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",Bt(o),_t(o,c),Lt(c);const _=!u.getQueryCache().get(o.queryHash),[f]=O.useState(()=>new t(u,o)),g=f.getOptimisticResult(o),L=!r&&e.subscribed!==!1;if(O.useSyncExternalStore(O.useCallback(d=>{const j=L?f.subscribe(gt.batchCalls(d)):X;return f.updateResult(),j},[f,L]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),O.useEffect(()=>{f.setOptions(o)},[o,f]),Ht(o,g))throw vt(o,f,c);if(kt({result:g,errorResetBoundary:c,throwOnError:o.throwOnError,query:u.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw g.error;return u.getDefaultOptions().queries?._experimental_afterQuery?.(o,g),o.experimental_prefetchInRender&&!Y&&At(g,r)&&(_?vt(o,f,c):u.getQueryCache().get(o.queryHash)?.promise)?.catch(X).finally(()=>{f.updateResult()}),o.notifyOnChangeProps?g:f.trackResult(g)}function Kt(e,t){return jt(e,wt)}export{Kt as u};
