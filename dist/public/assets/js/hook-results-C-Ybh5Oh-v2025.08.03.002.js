import{r as p,j as e,x as h,a as Y,c as X,g as Z,C as S,d as F,aN as A,aO as y,e as b,B as w,J as B,F as ee}from"./index-DcVH0HiB-v2025.08.03.002.js";import{C as D,H as L,e as te}from"./dropdown-menu-D_94bytK-v2025.08.03.002.js";const M=p.forwardRef(({className:t,...a},o)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:o,className:h("w-full caption-bottom text-sm",t),...a})}));M.displayName="Table";const E=p.forwardRef(({className:t,...a},o)=>e.jsx("thead",{ref:o,className:h("[&_tr]:border-b",t),...a}));E.displayName="TableHeader";const $=p.forwardRef(({className:t,...a},o)=>e.jsx("tbody",{ref:o,className:h("[&_tr:last-child]:border-0",t),...a}));$.displayName="TableBody";const se=p.forwardRef(({className:t,...a},o)=>e.jsx("tfoot",{ref:o,className:h("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a}));se.displayName="TableFooter";const I=p.forwardRef(({className:t,...a},o)=>e.jsx("tr",{ref:o,className:h("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a}));I.displayName="TableRow";const u=p.forwardRef(({className:t,...a},o)=>e.jsx("th",{ref:o,className:h("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a}));u.displayName="TableHead";const f=p.forwardRef(({className:t,...a},o)=>e.jsx("td",{ref:o,className:h("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a}));f.displayName="TableCell";const ae=p.forwardRef(({className:t,...a},o)=>e.jsx("caption",{ref:o,className:h("mt-4 text-sm text-muted-foreground",t),...a}));ae.displayName="TableCaption";const oe=t=>{const a=(t||"").toLowerCase();return a.includes("problem-promise-proof")||a==="ppp"?"PPP":a.includes("4u")?"4U":a.includes("direct")?"Direct":a.includes("aida")?"AIDA":a.includes("pas")?"PAS":a.includes("open")?"Open Loop":"Direct"},re=(t,a)=>{const o=(a||"").trim();if(t==="tiktok")return{visual_cold_open:o.replace(/^visual:\s*/i,"")||"Quick motion (whip-in), title card snap"};if(t==="instagram"){let i=o.replace(/^overlay:\s*/i,"").replace(/"/g,"");return i.length>24&&(i=i.slice(0,24)),{overlay:i||"Save this"}}return{proof_cue:o.replace(/^proof:\s*/i,"")||"Result: +18% watch"}},H=t=>(t||"").trim().split(/\s+/).filter(Boolean).length,O=t=>`${t.slice(0,64)}::${t.length}`,le=(t,a)=>{if(t.text!==void 0){const r=t;return{id:O(r.text),text:r.text,framework:r.framework,wordCount:r.word_count??H(r.text),platformNotes:r.platform_notes,rationale:r.rationale||"",aiScore:typeof r.ai_score=="number"?r.ai_score:null,scoreBreakdown:void 0}}else{const r=t,i=r.hook,m=oe(r.framework),d=r.wordCount??H(i),N=re(a,r.platformNotes);return{id:O(i),text:i,framework:m,wordCount:d,platformNotes:N,rationale:r.rationale||"",aiScore:typeof r.score=="number"?r.score:null,scoreBreakdown:r.scoreBreakdown}}},ie={tiktok:{mu:11,sigma:2.5},instagram:{mu:12,sigma:2.5},youtube:{mu:6,sigma:1.5}},ce=(t,{mu:a,sigma:o})=>Math.exp(-((t-a)**2)/(2*o**2)),ne={"Open Loop":.75,PPP:.7,"4U":.68,AIDA:.6,PAS:.62,Direct:.55},de=t=>[/you won't believe/i,/one weird trick/i,/blow your mind/i,/hack\b/i].some(o=>o.test(t))?-.08:0,me=(t,a)=>{if(a==="tiktok"){const i=!!t.platformNotes.visual_cold_open,m=/day\s*\d+|after\s+\d+|in\s+\d+\s*(days?|hours?|mins?)/i.test(t.text);return(i?.7:.4)+(m?.2:0)}if(a==="instagram"){const i=!!t.platformNotes.overlay,m=/\bhow to\b|do this|save this|step\-by\-step|checklist|template/i.test(t.text);return(i?.7:.4)+(m?.2:0)}const o=!!t.platformNotes.proof_cue,r=/\d+%|\b\d{1,3}(k|m)\b|\b(before|after)\b/i.test(t.text);return(o?.7:.4)+(r?.2:0)},xe=(t,a,o)=>{const r=ce(t.wordCount,ie[a]),i=me(t,a),m=ne[t.framework]??.55,d=de(t.text),v=.45*(o!==null?Math.max(0,Math.min(1,o/5)):.7)+.2*r+.25*Math.min(1,i)+.1*m+d;return+(5*Math.max(0,Math.min(1,v))).toFixed(2)},U=p.memo(({hook:t,index:a,copiedHook:o,favorites:r,expandedScores:i,onCopyToClipboard:m,onSaveFavorite:d,onToggleScoreExpansion:N})=>{const v=useCallback(c=>({"Open Loop":"bg-blue-100 text-blue-800",PPP:"bg-emerald-100 text-emerald-800","4U":"bg-violet-100 text-violet-800",AIDA:"bg-orange-100 text-orange-800",PAS:"bg-rose-100 text-rose-800",Direct:"bg-slate-100 text-slate-800"})[c]||"bg-slate-100 text-slate-800",[]),k=useCallback(c=>"visual_cold_open"in c.platformNotes?e.jsxs(e.Fragment,{children:["📹 ",c.platformNotes.visual_cold_open]}):"overlay"in c.platformNotes?e.jsxs(e.Fragment,{children:["💬 ",c.platformNotes.overlay]}):e.jsxs(e.Fragment,{children:["📊 ",c.platformNotes.proof_cue]}),[]);return e.jsxs(y.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.6+a*.05,type:"spring",stiffness:120},className:"border-b border-slate-100 hover:bg-slate-50/80 transition-colors",children:[e.jsx(f,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center",children:[a===0&&e.jsx("div",{className:"w-6 h-6 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center text-xs font-bold mr-1",children:"1"}),a!==0&&e.jsx("span",{className:"text-slate-500 text-sm",children:a+1})]})}),e.jsx(f,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"font-medium text-slate-900 leading-tight",children:['"',t.text,'"']}),t.rationale&&e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed",children:t.rationale})]})}),e.jsx(f,{className:"text-center",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(b,{className:`${t.compositeScore>=4?"bg-emerald-100 text-emerald-800":t.compositeScore>=3?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"} font-mono`,children:t.compositeScore}),t.scoreBreakdown&&e.jsxs("div",{children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>N(t.id),className:"h-5 px-1 text-xs text-slate-500 hover:text-slate-700","aria-label":i.has(t.id)?"Hide score breakdown":"Show score breakdown",children:i.has(t.id)?e.jsx(ee,{className:"w-3 h-3"}):e.jsx(te,{className:"w-3 h-3"})}),i.has(t.id)&&e.jsx("div",{className:"mt-1 text-xs text-slate-600 bg-slate-50 rounded p-2 border",children:t.scoreBreakdown})]})]})}),e.jsx(f,{children:e.jsx(b,{className:v(t.framework),children:t.framework})}),e.jsx(f,{className:"text-center",children:e.jsx("span",{className:"text-sm text-slate-600",children:t.wordCount})}),e.jsx(f,{children:e.jsx("div",{className:"text-xs text-slate-600",children:k(t)})}),e.jsx(f,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>m(t.text),className:"h-8 w-8 p-0","aria-label":o===t.text?"Copied!":"Copy hook text",children:o===t.text?e.jsx(B,{className:"w-3 h-3 text-green-600"}):e.jsx(D,{className:"w-3 h-3"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>d(t),className:"h-8 w-8 p-0",disabled:r.has(t.text),"aria-label":r.has(t.text)?"Already saved":"Save to favorites",children:e.jsx(L,{className:`w-3 h-3 ${r.has(t.text)?"fill-current text-red-500":""}`})})]})})]},t.id)});U.displayName="HookTableRow";function pe({generation:t,userId:a}){const[o,r]=useState(new Set),[i,m]=useState(null),[d,N]=useState(new Set),[v,k]=useState(!1),{toast:c}=Y(),j=t.platform.toLowerCase(),T=useMemo(()=>!t?.hooks||!Array.isArray(t.hooks)?[]:t.hooks.map(s=>le(s,j)),[t.hooks,j]),g=useMemo(()=>T.map(s=>({...s,compositeScore:xe(s,j,s.aiScore)})),[T,j]),n=g.length?g.reduce((s,l)=>l.compositeScore>s.compositeScore?l:s):null,z=useMemo(()=>[...g].sort((s,l)=>l.compositeScore-s.compositeScore),[g]),G=s=>"visual_cold_open"in s.platformNotes?e.jsxs(e.Fragment,{children:["📹 ",s.platformNotes.visual_cold_open]}):"overlay"in s.platformNotes?e.jsxs(e.Fragment,{children:["💬 ",s.platformNotes.overlay]}):e.jsxs(e.Fragment,{children:["📊 ",s.platformNotes.proof_cue]}),C=s=>"visual_cold_open"in s.platformNotes?`Visual: ${s.platformNotes.visual_cold_open}`:"overlay"in s.platformNotes?`Overlay: ${s.platformNotes.overlay}`:`Proof: ${s.platformNotes.proof_cue}`;useEffect(()=>{},[null,v]);const _=X({mutationFn:async({hook:s,hookData:l,framework:x,platformNotes:K,topic:J,platform:V})=>(await Z("POST","/api/favorites",{userId:a,hook:s,hookData:l,framework:x,platformNotes:K,topic:J,platform:V})).json(),onSuccess:(s,l)=>{const x=new Set(d);x.add(l.hook),N(x),c({title:"Hook saved to favorites!",description:"You can find it in your favorites section."})},onError:s=>{c({title:"Failed to save favorite",description:s.message,variant:"destructive"})}}),P=useCallback(async s=>{try{await navigator.clipboard.writeText(s),m(s),setTimeout(()=>m(null),2e3),c({title:"Copied to clipboard!",description:"Hook has been copied to your clipboard."})}catch{c({title:"Failed to copy",description:"Unable to copy to clipboard.",variant:"destructive"})}},[c]),R=useCallback(s=>{if(d.has(s.text)){c({title:"Already saved!",description:"This hook is already in your favorites."});return}const l=t.hooks.find(x=>x.verbalHook===s.text||x.hook===s.text);_.mutate({hook:s.text,hookData:l?{verbalHook:l.verbalHook||l.hook||s.text,visualHook:l.visualHook,textualHook:l.textualHook,framework:s.framework,psychologicalDriver:l.psychologicalDriver,hookCategory:l.hookCategory,score:s.aiScore,scoreBreakdown:l.scoreBreakdown,rationale:l.rationale,platformNotes:C(s),platformSpecific:l.platformSpecific}:{verbalHook:s.text,framework:s.framework,platformNotes:C(s)},framework:s.framework,platformNotes:C(s),topic:t.topic,platform:t.platform})},[d,t.hooks,t.topic,t.platform,_,c,a]),Q=useCallback(s=>({"Open Loop":"bg-blue-100 text-blue-800",PPP:"bg-emerald-100 text-emerald-800","4U":"bg-violet-100 text-violet-800",AIDA:"bg-orange-100 text-orange-800",PAS:"bg-rose-100 text-rose-800",Direct:"bg-slate-100 text-slate-800"})[s]||"bg-slate-100 text-slate-800",[]),W=useCallback(s=>{const l=s.toLowerCase();return l==="tiktok"?"🎵":l==="instagram"?"📸":l==="youtube"?"▶️":"📱"},[]),q=useCallback(s=>{r(l=>{const x=new Set(l);return x.has(s)?x.delete(s):x.add(s),x})},[]);return!t.hooks||t.hooks.length===0?e.jsx(S,{children:e.jsx(F,{className:"p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"No hooks generated yet."})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{mode:"wait",children:n&&e.jsx(y.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.6,delay:.2,type:"spring",stiffness:100},children:e.jsx(S,{className:"border border-blue-300/50 bg-gradient-to-r from-blue-50 to-blue-100/50 relative overflow-hidden",children:e.jsx(F,{className:"p-6 relative z-10",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-700",children:"🏆 HIGHEST SCORING HOOK"}),e.jsx(y.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring",stiffness:200},children:e.jsxs(b,{className:"bg-amber-100 text-amber-800 border-amber-200 font-medium",children:["★ ",n.compositeScore,"/5.0 Score"]})})]}),e.jsxs("blockquote",{className:"text-lg font-semibold text-slate-900 border-l-4 border-blue-400 pl-4 bg-white/70 rounded-r-lg py-2",children:['"',n.text,'"']}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(b,{className:"bg-blue-100 text-blue-700 font-medium",children:["AI: ",n.aiScore?n.aiScore.toFixed(1):"N/A","/5"]}),e.jsx(b,{className:Q(n.framework),children:n.framework}),e.jsxs(b,{variant:"secondary",className:"bg-slate-100 text-slate-600",children:[n.wordCount," words"]})]}),e.jsxs("div",{className:"text-sm text-slate-600 bg-white/60 rounded-lg p-3",children:[e.jsx("p",{className:"font-medium text-slate-700 mb-2",children:"Platform Notes:"}),e.jsx("div",{className:"text-sm",children:G(n)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(w,{onClick:()=>P(n.text),className:"bg-blue-600 hover:bg-blue-700 text-white",children:i===n.text?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Copy Best Line"]})}),e.jsxs(w,{onClick:()=>R(n),variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-50",disabled:d.has(n.text),children:[e.jsx(L,{className:`w-4 h-4 mr-2 ${d.has(n.text)?"fill-current":""}`}),d.has(n.text)?"Saved":"Save"]})]})]})})})},`best-hook-${t.id}`)}),e.jsx(A,{mode:"wait",children:e.jsx(y.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4,type:"spring",stiffness:80},children:e.jsx(S,{children:e.jsxs(F,{className:"p-0",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50/50",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"All Generated Hooks"}),e.jsxs(b,{variant:"secondary",className:"bg-slate-200 text-slate-700",children:[W(t.platform)," ",t.platform.charAt(0).toUpperCase()+t.platform.slice(1)]}),e.jsx(b,{variant:"secondary",className:"bg-emerald-100 text-emerald-800",children:t.objective.replace("_"," ").toUpperCase()})]})}),e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"Original Topic:"}),e.jsxs("p",{className:"text-sm text-blue-700 italic",children:['"',t.topic,'"']})]})]}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs(M,{role:"table","aria-label":"Generated hooks results",children:[e.jsx(E,{children:e.jsxs(I,{className:"bg-slate-50",children:[e.jsx(u,{className:"w-12 text-center",scope:"col",children:"Rank"}),e.jsx(u,{scope:"col",children:"Hook"}),e.jsx(u,{className:"w-24 text-center",scope:"col",children:"Score"}),e.jsx(u,{className:"w-32",scope:"col",children:"Framework"}),e.jsx(u,{className:"w-20 text-center",scope:"col",children:"Words"}),e.jsx(u,{className:"w-32",scope:"col",children:"Platform Notes"}),e.jsx(u,{className:"w-24 text-center",scope:"col",children:"Actions"})]})}),e.jsx($,{children:z.map((s,l)=>e.jsx(U,{hook:s,index:l,copiedHook:i,favorites:d,expandedScores:o,onCopyToClipboard:P,onSaveFavorite:R,onToggleScoreExpansion:q},s.id))})]})})]})})},`hooks-table-${t.id}`)})]},t.id)}const Ne=p.memo(pe);export{Ne as default};
